use_directory("inst")
use_build_ignore("3.6.0")
library(r2dii.ci)
system.file("Dockerfile")
library(r2dii.ci)
system.file()
devtools::load_all(".")
system.file("Dockerfile", package = "r2dii.ci")
path <- system.file("Dockerfile", package = "r2dii.ci")
path
readr::read_lines(path)
glue::glue("3.{}.0")
glue::glue("3.{1:3}.0")
glue::glue("3.{2:6}.0")
rversions <- glue::glue("3.{2:6}.0")
rversions
r_versions <- glue::glue("3.{2:6}.0")
r_versions
path
library(r2dii.ci)
path <- system.file("Dockerfile", package = "r2dii.ci")
readr::read_lines(path)
library(r2dii.ci)
r_version <- glue::glue("3.{2:6}.0")
glue::glue("FROM colinfay/r-ci-tidyverse:{r_version}")
from_image <- glue::glue("FROM colinfay/r-ci-tidyverse:{r_version}")
from_image
readr::read_lines(path)
docker_file <- readr::read_lines(path)
c("hello") %>%
purrr::map(~ c(.x, docker_file))
from_image %>%
purrr::map(~ c(.x, docker_file))
library(r2dii.ci)
path <- system.file("Dockerfile", package = "r2dii.ci")
docker_file <- readr::read_lines(path)
r_version <- glue::glue("3.{2:6}.0")
from_image <- glue::glue("FROM colinfay/r-ci-tidyverse:{r_version}")
from_image %>%
purrr::map(~ c(.x, docker_file))
enlist_dockerfiles <- function(readr, read_lines, glue, purrr, map, .x) {
path <- system.file("Dockerfile", package = "r2dii.ci")
docker_file <- readr::read_lines(path)
from_image <- glue::glue("FROM colinfay/r-ci-tidyverse:{r_version}")
purrr::map(from_image, ~ c(.x, docker_file))
}
enlist_dockerfiles <- function(r_version) {
path <- system.file("Dockerfile", package = "r2dii.ci")
docker_file <- readr::read_lines(path)
from_image <- glue::glue("FROM colinfay/r-ci-tidyverse:{r_version}")
purrr::map(from_image, ~ c(.x, docker_file))
}
r_version <- glue::glue("3.{2:6}.0")
enlist_dockerfiles(r_version)
devtools::load_all(".")
r_version <- glue::glue("3.{2:6}.0")
enlist_dockerfiles(r_version)
from_image
#' Create a list of docker files from a vector or r versions
#'
#' @param r_version
#'
#' @return
#' @export
#'
#' @examples
#' r_version <- glue::glue("3.{2:6}.0")
#' enlist_dockerfiles(r_version)
enlist_dockerfiles <- function(r_version) {
path <- system.file("Dockerfile", package = "r2dii.ci")
docker_file <- readr::read_lines(path)
from_image <- glue::glue("FROM colinfay/r-ci-tidyverse:{r_version}")
out <- lapply(from_image, function(x) c(x, docker_file))
stats::setNames(out, r_version)
}
r_version <- glue::glue("3.{2:6}.0")
enlist_dockerfiles(r_version)
source('C:/Users/Mauro/git/r2dii.ci/R/enlist_dockerfile.R', echo=TRUE)
devtools::load_all(".")
r_version <- glue::glue("3.{2:6}.0")
enlist_dockerfiles(r_version)
r_version
glue::glue("FROM colinfay/r-ci-tidyverse:{r_version}")
sprintf("FROM colinfay/r-ci-tidyverse:s%", r_version)
sprintf("FROM colinfay/r-ci-tidyverse:s%", r_version)
enlist_dockerfiles(r_version)
sprintf("FROM colinfay/r-ci-tidyverse:s%", r_version)
sprintf("FROM colinfay/r-ci-tidyverse:%s", r_version)
devtools::load_all(".")
r_version <- glue::glue("3.{2:6}.0")
enlist_dockerfiles(r_version)
source('C:/Users/Mauro/git/r2dii.ci/R/enlist_dockerfile.R', echo=TRUE)
r_version <- glue::glue("3.{2:6}.0")
enlist_dockerfiles(r_version)
glue::glue("FROM colinfay/r-ci-tidyverse:{r_version}")
sprintf("FROM colinfay/r-ci-tidyverse:%s", r_version)
# from_image <- glue::glue("FROM colinfay/r-ci-tidyverse:{r_version}")
from_image <- sprintf("FROM colinfay/r-ci-tidyverse:%s\n", r_version)
from_image
devtools::load_all(".")
r_version <- glue::glue("3.{2:6}.0")
enlist_dockerfiles(r_version)
glue::glue("FROM colinfay/r-ci-tidyverse:{r_version}")
sprintf("FROM colinfay/r-ci-tidyverse:%s\n", r_version)
# from_image <- glue::glue("FROM colinfay/r-ci-tidyverse:{r_version}")
from_image <- cat(sprintf("FROM colinfay/r-ci-tidyverse:%s\n", r_version))
from_image
devtools::load_all(".")
r_version <- glue::glue("3.{2:6}.0")
enlist_dockerfiles(r_version)
devtools::load_all(".")
#' @param r_version
#'
#' @return
#' @export
#'
#' @examples
#' r_version <- glue::glue("3.{2:6}.0")
#' enlist_dockerfiles(r_version)
#'
#'
enlist_dockerfiles <- function(r_version) {
path <- system.file("Dockerfile", package = "r2dii.ci")
docker_file <- readr::read_lines(path)
from_image <- glue::glue("FROM colinfay/r-ci-tidyverse:{r_version}")
out <- lapply(from_image, function(x) c(x, docker_file))
stats::setNames(out, r_version)
}
r_version <- glue::glue("3.{2:6}.0")
enlist_dockerfiles(r_version)
devtools::load_all(".")
devtools::load_all(".")
r_version <- glue::glue("3.{2:6}.0")
enlist_dockerfiles(r_version)
docker_files <- enlist_dockerfiles(r_version)
r_version <- glue::glue("3.{2:6}.0")
docker_files <- enlist_dockerfiles(r_version)
docker_files
docker_files
purrr::walk2(r_version, docker_files, readr::write_lines)
r_version
r_version
outpath <- r_version
outpath
outpath[1]
readr::write_lines(docker_files[[1]], r_version[[1]]
)
docker_files[[1]]
r_version[[1]]
readr::write_lines(docker_files[[1]], "test.txt")
fs::path(r_version, "Dockerfile")
r_version <- c("3.6.0", "3.5.0")
r_version <- c("3.6.0", "3.5.0")
docker_files <- enlist_dockerfiles(r_version)
docker_files
r_version <- c("3.6.0", "3.5.0")
docker_files <- enlist_dockerfiles(r_version)
docker_files
devtools::load_all(".")
r_version <- c("3.6.0", "3.5.0")
docker_files <- enlist_dockerfiles(r_version)
docker_files
